# Nushell Environment Config File
#
# version = "0.108.0"

# Environment variables
$env.EDITOR = "nvim"
$env.SUDO_EDITOR = $env.EDITOR

# Android SDK configuration
{{- if eq .chezmoi.os "darwin" }}
$env.ANDROID_SDK_ROOT = ($env.HOME | path join "Library" "Android" "sdk")
$env.ANDROID_HOME = ($env.HOME | path join "Library" "Android" "sdk")
$env.JAVA_HOME = "/Library/Java/JavaVirtualMachines/zulu-17.jdk/Contents/Home"
{{- else }}
$env.ANDROID_SDK_ROOT = "/home/raven/Android/Sdk"
$env.ANDROID_HOME = "/home/raven/Android/Sdk"
$env.JAVA_HOME = "/usr/lib/jvm/java-21-openjdk"
{{- end }}

# Path configuration
$env.PATH = ($env.PATH | split row (char esep) | prepend [
    "/usr/local/bin"
{{- if eq .chezmoi.os "darwin" }}
    "/opt/homebrew/bin"
    ($env.HOME | path join "Library" "Application Support" "Herd" "bin")
{{- end }}
    ($env.HOME | path join ".config" "composer" "vendor" "bin")
    ($env.HOME | path join ".local" "share" "mise" "installs" "node" "22.10.0" "bin")
    ($env.HOME | path join ".cargo" "bin")
    ($env.HOME | path join ".local" "bin")
    ($env.HOME | path join "go" "bin")
    ($env.HOME | path join ".opencode" "bin")
    ($env.ANDROID_SDK_ROOT | path join "emulator")
    ($env.ANDROID_SDK_ROOT | path join "platform-tools")
])

# 1Password SSH agent
{{- if eq .chezmoi.os "darwin" }}
$env.SSH_AUTH_SOCK = ($env.HOME | path join "Library" "Group Containers" "2BUA8C4S2C.com.1password" "t" "agent.sock")
{{- else }}
$env.SSH_AUTH_SOCK = ($env.HOME | path join ".1password" "agent.sock")
{{- end }}

# NVM Directory
{{- if eq .chezmoi.os "darwin" }}
$env.NVM_DIR = ($env.HOME | path join "Library" "Application Support" "Herd" "config" "nvm")
{{- else }}
$env.NVM_DIR = ($env.HOME | path join ".nvm")
{{- end }}

{{- if eq .chezmoi.os "darwin" }}
# Herd PHP configuration
$env.HERD_PHP_84_INI_SCAN_DIR = ($env.HOME | path join "Library" "Application Support" "Herd" "config" "php" "84")
$env.HERD_PHP_83_INI_SCAN_DIR = ($env.HOME | path join "Library" "Application Support" "Herd" "config" "php" "83")
$env.HERD_PHP_82_INI_SCAN_DIR = ($env.HOME | path join "Library" "Application Support" "Herd" "config" "php" "82")
$env.HERD_PHP_80_INI_SCAN_DIR = ($env.HOME | path join "Library" "Application Support" "Herd" "config" "php" "80")
$env.HERD_PHP_74_INI_SCAN_DIR = ($env.HOME | path join "Library" "Application Support" "Herd" "config" "php" "74")
{{- end }}

# Starship prompt
try {
    mkdir ~/.cache/starship
    if (which starship | is-not-empty) {
        starship init nu | save -f ~/.cache/starship/init.nu
    }
} catch { |e| }

# Zoxide (replaces cd command)
try {
    if (which zoxide | is-not-empty) {
        zoxide init nushell --cmd cd | save -f ~/.zoxide.nu
    }
} catch { |e| }